<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeeGramm üêù - –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä —Å –ø—á–µ–ª–∏–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–æ–π</title>
    <link rel="stylesheet" href="/static/css/style.css?v=20260123">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üêù</text></svg>">
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
    <div id="auth-screen" class="auth-screen">
        <div class="auth-container">
            <div class="auth-header">
                <h1>üêù BeeGramm</h1>
                <p class="tagline">–ñ—É–∂–∂–∏ –≤–º–µ—Å—Ç–µ —Å –¥—Ä—É–∑—å—è–º–∏! üçØ</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">–í—Ö–æ–¥</button>
                <button class="auth-tab" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>
            
            <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
            <div id="login-form" class="auth-form active">
                <div class="form-group">
                    <label>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="login-username" placeholder="username">
                </div>
                <div class="form-group">
                    <label>üîí –ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="login-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="btn-primary" onclick="login()">
                    –í–æ–π—Ç–∏ –≤ —É–ª–µ–π üêù
                </button>
                <div id="login-error" class="error-message"></div>
            </div>
            
            <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
            <div id="register-form" class="auth-form">
                <div class="form-group">
                    <label>üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="register-username" placeholder="username" maxlength="32" pattern="[A-Za-z0-9]+" title="–¢–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã" oninput="sanitizeUsernameInput(this)">
                </div>
                <div class="form-group">
                    <label>‚ú® –ù–∏–∫–Ω–µ–π–º</label>
                    <input type="text" id="register-nickname" placeholder="–í–µ—Å—ë–ª–∞—è –ø—á—ë–ª–∫–∞">
                </div>
                <div class="form-group">
                    <label>üîí –ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="register-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button class="btn-primary" onclick="register()">
                    –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç üçØ
                </button>
                <div id="register-error" class="error-message"></div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞–Ω–∞–ª–æ–≤ -->
    <div id="channels-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ö–∞–Ω–∞–ª—ã üì¢</h2>
                <button class="btn-close" onclick="closeChannelsModal()">‚úï</button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label>üîç –ù–∞–π—Ç–∏ –∫–∞–Ω–∞–ª</label>
                    <input type="text" id="channel-search" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ..." oninput="searchChannels()">
                </div>

                <div class="channels-actions">
                    <button class="btn-primary" onclick="createChannelPrompt()">‚ûï –°–æ–∑–¥–∞—Ç—å –∫–∞–Ω–∞–ª</button>
                </div>

                <div id="channels-list" class="channels-list">
                    <!-- –ö–∞–Ω–∞–ª—ã -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div id="app-screen" class="app-screen" style="display: none;">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="user-profile-mini" onclick="openProfile()">
                    <img id="sidebar-avatar" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üë§</text></svg>" alt="Avatar" class="avatar-mini">
                    <div class="user-info-mini">
                        <div class="user-name-mini" id="sidebar-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                        <div class="user-stars" id="sidebar-stars">100 üêù</div>
                    </div>
                </div>
                <div class="sidebar-actions">
                    <button class="btn-icon btn-premium-activate" onclick="openPremiumModal()" title="BeeGramm Premium" id="premium-btn">
                        ‚≠ê
                    </button>
                    <button class="btn-icon" onclick="openSupport()" title="–ü–æ–¥–¥–µ—Ä–∂–∫–∞" id="support-btn">
                        üõü
                    </button>
                    <button class="btn-icon" onclick="openChannels()" title="–ö–∞–Ω–∞–ª—ã" id="channels-btn">
                        üì¢
                    </button>
                    <button class="btn-icon" onclick="toggleTheme()" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É" id="theme-toggle">
                        üåô
                    </button>
                    <button class="btn-icon" onclick="openNewChat()" title="–ù–æ–≤—ã–π —á–∞—Ç">
                        ‚ûï
                    </button>
                    <button class="btn-icon" onclick="window.location.href='/admin'" title="–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å" id="admin-btn" style="display: none;">
                        üëë
                    </button>
                    <button class="btn-icon" onclick="window.location.href='/moderator'" title="–ú–æ–¥–µ—Ä-–ø–∞–Ω–µ–ª—å" id="moderator-btn" style="display: none;">
                        üõ°Ô∏è
                    </button>
                </div>
            </div>
            
            <div class="search-bar">
                <input type="text" id="chat-search" placeholder="üîç –ü–æ–∏—Å–∫ —á–∞—Ç–æ–≤...">
            </div>
            
            <div class="chats-list" id="chats-list">
                <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
        </div>
        
        <!-- –û–±–ª–∞—Å—Ç—å —á–∞—Ç–∞ -->
        <div class="chat-area">
            <div id="no-chat-selected" class="no-chat-selected">
                <div class="bee-animation">üêù</div>
                <h2>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∂—É–∂–∂–∞—Ç—å! üçØ</h2>
                <p>–ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —á–∞—Ç —Å –¥—Ä—É–∑—å—è–º–∏</p>
            </div>
            
            <div id="chat-container" class="chat-container" style="display: none;">
                <!-- –®–∞–ø–∫–∞ —á–∞—Ç–∞ -->
                <div class="chat-header">
                    <div class="chat-header-info">
                        <img id="chat-avatar" src="" alt="Avatar" class="avatar-medium">
                        <div>
                            <div class="chat-name" id="chat-name">–ß–∞—Ç</div>
                            <div class="chat-status" id="chat-status">–æ–Ω–ª–∞–π–Ω</div>
                        </div>
                    </div>
                    <div class="chat-header-actions">
                        <button class="btn-icon" onclick="startVoiceCall()" title="–ó–≤–æ–Ω–æ–∫" id="call-btn" style="display:none;">
                            üìû
                        </button>
                        <button class="btn-icon" onclick="openChatInfo()" title="–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è">
                            ‚ÑπÔ∏è
                        </button>
                    </div>
                </div>
                
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
                <div class="messages-container" id="messages-container">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ -->
                <div id="typing-indicator" class="typing-indicator" style="display: none;">
                    <span id="typing-user"></span> –ø–µ—á–∞—Ç–∞–µ—Ç...
                </div>
                
                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
                <div class="message-input-container">
                    <button class="btn-icon" onclick="openStickers()" title="–°—Ç–∏–∫–µ—Ä—ã">
                        üòä
                    </button>
                    <button class="btn-icon" onclick="toggleVoiceRecord()" title="–ì–æ–ª–æ—Å–æ–≤–æ–µ" id="voice-btn">
                        üé§
                    </button>
                    <button class="btn-icon" onclick="openFileUpload()" title="–§–∞–π–ª">
                        üìé
                    </button>
                    <input type="file" id="file-input" style="display: none;" onchange="uploadFile(this)">
                    <div class="message-input-wrap">
                        <textarea id="message-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ... üêù" 
                              onkeypress="handleMessageKeyPress(event)" 
                              oninput="handleTyping()" 
                              rows="1"></textarea>
                        <div class="message-counter" id="message-counter">0/500</div>
                    </div>
                    <button class="btn-send" onclick="sendMessage()">
                        ‚û§
                    </button>
                </div>
            </div>
        </div>
        
        <!-- –ü–∞–Ω–µ–ª—å –ø—Ä–æ—Ñ–∏–ª—è (—Å–ø—Ä–∞–≤–∞) -->
        <div id="profile-panel" class="profile-panel">
            <div class="profile-header">
                <h2>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å üêù</h2>
                <button class="btn-close" onclick="closeProfile()">‚úï</button>
            </div>
            
            <div class="profile-content">
                <div class="profile-avatar-section">
                    <img id="profile-avatar" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üë§</text></svg>" alt="Avatar" class="avatar-large">
                    <button class="btn-secondary" onclick="changeAvatar()">
                        –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ç–æ üì∏
                    </button>
                    <input type="file" id="avatar-input" style="display: none;" accept="image/*" onchange="uploadAvatar(this)">
                </div>
                
                <div class="profile-info">
                    <div class="profile-field">
                        <label>‚ú® –ù–∏–∫–Ω–µ–π–º</label>
                        <input type="text" id="profile-nickname" placeholder="–í–∞—à –Ω–∏–∫–Ω–µ–π–º">
                    </div>
                    
                    <div class="profile-field">
                        <label>üë§ Username</label>
                        <input type="text" id="profile-username" readonly>
                    </div>
                    
                    <div class="profile-field">
                        <label>üìù –û —Å–µ–±–µ</label>
                        <textarea id="profile-bio" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ..." rows="3"></textarea>
                    </div>
                    
                    <div class="profile-field">
                        <label>üí¨ –°—Ç–∞—Ç—É—Å</label>
                        <input type="text" id="profile-status" placeholder="–ñ—É–∂–∂—É –≤ BeeGramm üêù">
                    </div>
                    
                    <div class="profile-stats">
                        <div class="stat">
                            <div class="stat-value" id="profile-stars">100</div>
                            <div class="stat-label">üêù –ü—á—ë–ª–∫–∏</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value" id="profile-premium">
                                <span id="premium-badge">–û–±—ã—á–Ω—ã–π</span>
                            </div>
                            <div class="stat-label">–°—Ç–∞—Ç—É—Å</div>
                        </div>
                    </div>
                    
                    <button class="btn-primary" onclick="saveProfile()">
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è üíæ
                    </button>
                    
                    <div class="premium-section">
                        <h3>üëë BeeGramm Premium</h3>
                        <ul>
                            <li>‚ú® –ó–æ–ª–æ—Ç–∞—è –ø—á—ë–ª–∫–∞ —Ä—è–¥–æ–º —Å –∏–º–µ–Ω–µ–º</li>
                            <li>üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ 100–ú–ë</li>
                            <li>üé® –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—ã</li>
                            <li>‚ö° –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
                        </ul>

                        <div class="profile-field" style="margin-top: 15px;">
                            <label>üñºÔ∏è –û–±–æ–∏ —á–∞—Ç–∞ (Premium)</label>
                            <select id="premium-wallpaper" onchange="setPremiumWallpaper(this.value)" style="width: 100%; padding: 12px 16px; border-radius: 10px; border: 2px solid var(--bee-yellow);">
                                <option value="default">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</option>
                                <option value="honey">–ú—ë–¥</option>
                                <option value="lavender">–õ–∞–≤–∞–Ω–¥–∞</option>
                                <option value="night">–ù–æ—á—å</option>
                            </select>
                            <div id="premium-wallpaper-hint" style="margin-top: 8px; font-size: 13px; color: #666;">
                                –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è Premium
                            </div>
                        </div>
                        <button class="btn-premium" onclick="alert('–ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üêù')">
                            –ü–æ–ª—É—á–∏—Ç—å Premium üëë
                        </button>
                    </div>

                    <button class="btn-secondary" onclick="logout()" style="margin-top: 15px; background: #fff; border: 2px solid #ff6b6b; color: #ff6b6b;">
                        –í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞ üö™
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞ -->
    <div id="new-chat-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤—ã–π —á–∞—Ç üí¨</h2>
                <button class="btn-close" onclick="closeNewChatModal()">‚úï</button>
            </div>
            
            <div class="modal-body">
                <div class="form-group">
                    <label>üîç –ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="user-search" placeholder="–í–≤–µ–¥–∏—Ç–µ username..." oninput="searchUsers()">
                </div>
                
                <div id="users-list" class="users-list">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∏–∫–µ—Ä–æ–≤ -->
    <div id="stickers-modal" class="modal">
        <div class="modal-content stickers-modal">
            <div class="modal-header">
                <h2>–°—Ç–∏–∫–µ—Ä—ã üêù</h2>
                <button class="btn-close" onclick="closeStickersModal()">‚úï</button>
            </div>
            
            <div class="modal-body">
                <div id="stickers-container" class="stickers-container">
                    <!-- –°—Ç–∏–∫–µ—Ä—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Ç–µ -->
    <div id="chat-info-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ ‚ÑπÔ∏è</h2>
                <button class="btn-close" onclick="closeChatInfoModal()">‚úï</button>
            </div>
            
            <div class="modal-body" id="chat-info-content">
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ -->
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Premium -->
    <div id="premium-modal" class="modal">
        <div class="modal-content premium-modal">
            <div class="modal-header premium-header">
                <h2>‚≠ê BeeGramm Premium</h2>
                <button class="btn-close" onclick="closePremiumModal()">‚úï</button>
            </div>
            
            <div class="modal-body">
                <div class="premium-features">
                    <h3>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Premium:</h3>
                    <ul class="premium-list">
                        <li>‚ú® –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –¥–æ 100 –ú–ë (–≤–º–µ—Å—Ç–æ 10 –ú–ë)</li>
                        <li>üé® –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—ã</li>
                        <li>üëë –ó–Ω–∞—á–æ–∫ Premium –≤ –ø—Ä–æ—Ñ–∏–ª–µ</li>
                        <li>üêù –ë–æ–ª—å—à–µ –ø—á—ë–ª–æ–∫ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</li>
                        <li>üöÄ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
                    </ul>
                    
                    <div class="premium-price">
                        <span class="price-amount">199 ‚ÇΩ</span>
                        <span class="price-period">–Ω–∞–≤—Å–µ–≥–¥–∞</span>
                    </div>
                    
                    <div class="premium-activation">
                        <p>–ö—É–ø–∏—Ç–µ –∫–ª—é—á –Ω–∞ FunPay –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –∑–¥–µ—Å—å:</p>
                        <input type="text" id="premium-key-input" placeholder="BEE-XXXX-XXXX" class="premium-key-input">
                        <button class="btn-premium" onclick="activatePremium()">
                            üéâ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å Premium
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="early-access-modal" class="modal">
        <div class="modal-content" style="max-width: 560px;">
            <div class="modal-header">
                <h2>üóùÔ∏è Early Access</h2>
                <button class="btn-close" onclick="closeEarlyAccessModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 12px;">BeeGramm —Å–µ–π—á–∞—Å –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –Ω—É–∂–µ–Ω –∫–ª—é—á —Ä–∞–Ω–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞.</p>
                <div class="form-group">
                    <label>–ö–ª—é—á</label>
                    <input type="text" id="early-access-key-input" placeholder="EA-XXXX-XXXX" style="text-transform: uppercase;">
                </div>
                <button class="btn-primary" onclick="activateEarlyAccess()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                <div id="early-access-error" class="error-message" style="margin-top: 10px;"></div>
            </div>
        </div>
    </div>

    <div id="call-modal" class="modal">
        <div class="modal-content" style="max-width: 520px;">
            <div class="modal-header">
                <h2 id="call-title">üìû –ó–≤–æ–Ω–æ–∫</h2>
                <button class="btn-close" onclick="hangupCall()">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="call-status" style="margin-bottom: 12px; color: var(--gray-dark);">‚Äî</div>
                <div style="display:flex; gap:10px;">
                    <button class="btn-primary" id="call-accept" onclick="acceptCall()" style="display:none;">–ü—Ä–∏–Ω—è—Ç—å</button>
                    <button class="btn-danger" id="call-hangup" onclick="hangupCall()">–°–±—Ä–æ—Å–∏—Ç—å</button>
                    <button class="btn-secondary" id="call-mute" onclick="toggleMute()" style="display:none;">–ú–∏–∫—Ä–æ—Ñ–æ–Ω</button>
                </div>
                <audio id="remote-audio" autoplay></audio>
            </div>
        </div>
    </div>
    
    <!-- –ê–Ω–∏–º–∞—Ü–∏—è –ø—á—ë–ª–∫–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è -->
    <div id="bee-fly-animation" class="bee-fly-animation">üêù</div>
    
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="/static/js/main.js?v=20260123"></script>
</body>
</html>
